
{% extends 'base.html' %}
{% load static %}
{% block content %}
<section class="hero mb-4" style="background-image:url('{% static "img/hero.jpg" %}');background-size:cover;background-position:center;padding:80px 0;color:#fff">
  <div class="container text-center">
    <h1 class="display-5 fw-bold">Discover Your Next Adventure</h1>
    <p class="lead">Find top destinations, tours and great offers. Book online in minutes.</p>
    <form method="get" class="row g-2 justify-content-center mt-3" style="max-width:800px;margin:0 auto;">
      <div class="col-12 col-md-5">
        <input name="q" class="form-control search-input" placeholder="Where to?" value="{{ request.GET.q }}">
      </div>
      <div class="col-12 col-md-3">
        <input name="date" class="form-control" placeholder="Dates (optional)">
      </div>
      <div class="col-12 col-md-2">
        <button class="btn btn-dark w-100">Find Now</button>
      </div>
    </form>
  </div>
</section>
<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>Available Tours</h2>
  <form method="get" class="d-flex" style="max-width:360px">
    <input name="q" class="form-control me-2" placeholder="Search destination or tour" value="{{ request.GET.q }}">
    <button class="btn btn-outline-light btn-primary">Search</button>
  </form>
</div>
<div class="row">
  {% for tour in tours %}
  <div class="col-md-4">
    <div class="card mb-3 shadow-sm">
      <div class="card-cover">
      {% if tour.destination.image %}
        <img src="{{ tour.destination.image.url }}" style="width:100%;height:220px;object-fit:cover">
      {% elif tour.image %}
        <img src="{{ tour.image.url }}" style="width:100%;height:220px;object-fit:cover">
      {% else %}
        <img src="/static/img/placeholder.jpg" style="width:100%;height:220px;object-fit:cover">
      {% endif %}
      <div class="overlay">
        <div class="actions">
          <a href="{% url 'tour_detail' tour.id %}" class="btn btn-sm btn-light">View</a>
          <a href="{% url 'book_tour' tour.id %}" class="btn btn-sm btn-primary ms-2">Book</a>
        </div>
      </div>
      </div>
      <div class="card-body">
        <h5 class="card-title">{{ tour.title }}</h5>
        <p class="card-text small text-muted">{{ tour.destination.name }}</p>
        <div class="d-flex justify-content-between align-items-center">
          <div>
            {% if tour.is_promotion and tour.discount_percent %}
              <div class="price-old">{{ tour.price_per_night }} MAD</div>
              <div class="price-new">{{ tour.discounted_price }} MAD</div>
            {% else %}
              <div class="fs-5">{{ tour.price_per_night }} MAD</div>
            {% endif %}
          </div>
          <div>
            <a href="{% url 'tour_detail' tour.id %}" class="btn btn-sm btn-primary">View</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  {% endfor %}
</div>
{% endblock %}
